<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2155106 염성현 성적 관리 사이트</title>
    <script src="https://code.jquery.com/jquery-3.6.4.js"></script>
    <script src="https://code.jquery.com/jquery-migrate-3.4.1.js"></script>
</head>

<body>
    <!-- part1 로그인 및 회원 가입 화면 -->
    <div id="part1">
        <h1>성적 관리 사이트</h1>
        <button id="showLoginSection">로그인 하러가기</button>
        <button id="showRegisterSection">회원가입 하러가기</button>
        <!-- 로그인 화면 -->
        <div id="loginSection" style="display: none;">
            <h2>로그인</h2>
            <input type="text" id="login_id" placeholder="아이디를 입력하세요.">
            <input type="password" id="login_password" placeholder="비밀번호를 입력하세요">
            <button id="login">로그인</button>
        </div>
        <!-- 회원가입 화면 -->
        <div id="registerSection" style="display: none;">
            <h2>회원 가입</h2>
            <input type="text" id="register_id" placeholder="아이디를 입력하세요.">
            <input type="password" id="register_password" placeholder="비밀번호를 입력하세요">
            <input type="text" id="register_name" placeholder="이름을 입력하세요">
            <button id="register">회원가입</button>
        </div>


    </div>

    <!-- part2 관리자 화면 -->

    <div id="part2" style="display: none;">
    </div>

    <!-- part3 일반 사용자 화면 -->
    <div id="part3" style="display: none;">

    </div>

    <script>
        $(function () {
            /** part1 **/
            //아이디 및 비밀번호 저장
            var usersList = {
                admin: 'admin'
            }
            //아이디 및 이름 저장
            var usersName = {
                admin: '관리자'
            }

            //로그인 하러가기
            var showLoginHandler = function () {
                $('#registerSection').hide();
                $('#loginSection').show();
            }

            //회원가입 하러가기
            var showRegisterHandler = function () {
                $('#loginSection').hide();
                $('#registerSection').show();
            }

            
            //아이디 체크 (영문자 또는 영문 숫자 3~20자)
            function isId(id) {
                var regExp = /^[0-9a-zA-Z]{3,20}$/;

                return regExp.test(id);
            }

            //비밀번호 체크 (5 ~ 16자 영문 또는 영문 숫자 조합)

            function isPassword(password) {
                var regExp = /^[0-9a-zA-Z]{5,16}$/;

                return regExp.test(password);
            }

            //이름 체크 (한글,영문)
            function isName(name) {
                var regExp = /^[a-zA-Zㄱ-힣][a-zA-Zㄱ-힣 ]*$/;

                return regExp.test(name);
            }


            // 유효성 검사 함수
            function validateInput(id, password, name) {
                if (id == '' || password == '') {
                    alert('아이디 또는 비밀번호를 입력해주세요.');
                    $(id).focus();
                    return false;
                }
                else if (!isId(id)) {
                    alert('아이디는 영문자 또는 숫자 3 ~ 20자를 입력해주세요.');
                    $(id).val('');
                    $(password).val('');
                    $(id).focus();
                    return false;
                }
                else if (!isPassword(password)) {
                    alert('비밀번호는 5 ~ 16자 영문 또는 영문과 숫자를 조합해야합니다.');
                    $(id).val('');
                    $(password).val('');
                    $(password).focus();
                    return false;
                }
                else if (name && !isName(name)) {
                    alert('이름은 반드시 한글 또는 영어로 작성해야합니다.');
                    return false;
                }

                return true;
            }

            //로그인 구현
            var loginHandler = function () {
                var id = $('#login_id').val();
                var password = $('#login_password').val();

                // 유효성 검사
                if (!validateInput(id, password)) {
                    return;
                }
                //로그인 성공 
                else if (usersList[id] && usersList[id] === password) {
                    if (id == 'admin') {
                        $('#part1').hide();
                        $('#part2').show();
                        alert('로그인 성공: 관리자 페이지로 접속하셨습니다.');
                    }
                    else {
                        $('#part1').hide();
                        $('#part3').show();
                        alert(`로그인 성공: ${usersName[id]}님 어서오세요! 자신의 학점을 확인할 수 있습니다.`);
                    }
                }
                else alert("아이디가 존재하지 않거나, 아이디 또는 비밀번호가 틀립니다.");
            }


            //회원가입 구현
            var registerHandler = function () {
                var id = $('#register_id').val();
                var password = $('#register_password').val();
                var name = $('#register_name').val();

                // 유효성 검사
                if (!validateInput(id, password, name)) {
                    return;
                }

                else if (!usersList[id]) {
                    usersList[id] = password;
                    usersName[id] = name;
                    alert(`${usersName[id]}님 환영합니다. 회원가입에 성공하셨습니다! 로그인 해주세요!`);
                    $('#registerSection').hide();
                    $('#loginSection').show();
                } else {
                    alert('이미 존재하는 아이디입니다.');
                }

            }



            //이벤트 등록
            $('#showLoginSection').on('click', showLoginHandler)
            $('#showRegisterSection').on('click', showRegisterHandler)
            $('#login').on('click', loginHandler)
            $('#register').on('click', registerHandler)
        });
    </script>
</body>


</html>